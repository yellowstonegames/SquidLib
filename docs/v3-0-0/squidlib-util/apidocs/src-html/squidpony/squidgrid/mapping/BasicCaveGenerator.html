<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>Source code</title>
<meta name="description" content="source: package: squidpony.squidgrid.mapping, class: BasicCaveGenerator">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body class="source">
<main role="main">
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span><a id="line.1">package squidpony.squidgrid.mapping;</a>
<span class="sourceLineNo">002</span><a id="line.2"></a>
<span class="sourceLineNo">003</span><a id="line.3">import squidpony.squidmath.GWTRNG;</a>
<span class="sourceLineNo">004</span><a id="line.4">import squidpony.squidmath.IRNG;</a>
<span class="sourceLineNo">005</span><a id="line.5"></a>
<span class="sourceLineNo">006</span><a id="line.6">public class BasicCaveGenerator implements IDungeonGenerator {</a>
<span class="sourceLineNo">007</span><a id="line.7">    public int width;</a>
<span class="sourceLineNo">008</span><a id="line.8">    public int height;</a>
<span class="sourceLineNo">009</span><a id="line.9">    public IRNG random;</a>
<span class="sourceLineNo">010</span><a id="line.10">    public char[][] dungeon;</a>
<span class="sourceLineNo">011</span><a id="line.11">    public BasicCaveGenerator(){</a>
<span class="sourceLineNo">012</span><a id="line.12">        this(80, 40);</a>
<span class="sourceLineNo">013</span><a id="line.13">    }</a>
<span class="sourceLineNo">014</span><a id="line.14">    public BasicCaveGenerator(int width, int height) {</a>
<span class="sourceLineNo">015</span><a id="line.15">        this(width, height, new GWTRNG());</a>
<span class="sourceLineNo">016</span><a id="line.16">    }</a>
<span class="sourceLineNo">017</span><a id="line.17">    public BasicCaveGenerator(int width, int height, IRNG random) {</a>
<span class="sourceLineNo">018</span><a id="line.18">        this.width = width;</a>
<span class="sourceLineNo">019</span><a id="line.19">        this.height = height;</a>
<span class="sourceLineNo">020</span><a id="line.20">        this.random = random;</a>
<span class="sourceLineNo">021</span><a id="line.21">    }</a>
<span class="sourceLineNo">022</span><a id="line.22"></a>
<span class="sourceLineNo">023</span><a id="line.23">    /**</a>
<span class="sourceLineNo">024</span><a id="line.24">     * Generates a dungeon or other map as a 2D char array. Any implementation may allow its own configuration and</a>
<span class="sourceLineNo">025</span><a id="line.25">     * customization of how dungeons are generated, but each must provide this as a sane default. Most implementations</a>
<span class="sourceLineNo">026</span><a id="line.26">     * should use the convention of '#' representing a wall and '.' representing a bare floor, but beyond that, anything</a>
<span class="sourceLineNo">027</span><a id="line.27">     * could be present in the char array.</a>
<span class="sourceLineNo">028</span><a id="line.28">     *</a>
<span class="sourceLineNo">029</span><a id="line.29">     * @return a 2D char array representing some kind of map, probably using standard conventions for walls/floors</a>
<span class="sourceLineNo">030</span><a id="line.30">     */</a>
<span class="sourceLineNo">031</span><a id="line.31">    @Override</a>
<span class="sourceLineNo">032</span><a id="line.32">    public char[][] generate() {</a>
<span class="sourceLineNo">033</span><a id="line.33">        if (dungeon == null || dungeon.length != width || dungeon.length &lt;= 0 || dungeon[0].length != height || dungeon[0].length &lt;= 0)</a>
<span class="sourceLineNo">034</span><a id="line.34">            dungeon = new char[width][height];</a>
<span class="sourceLineNo">035</span><a id="line.35">        for (int x = 0; x &lt; width; x++) {</a>
<span class="sourceLineNo">036</span><a id="line.36">            for (int y = 0; y &lt; height; y++) {</a>
<span class="sourceLineNo">037</span><a id="line.37">                if (random.nextDouble() &lt; 0.5)</a>
<span class="sourceLineNo">038</span><a id="line.38">                    dungeon[x][y] = '#';</a>
<span class="sourceLineNo">039</span><a id="line.39">                else</a>
<span class="sourceLineNo">040</span><a id="line.40">                    dungeon[x][y] = '.';</a>
<span class="sourceLineNo">041</span><a id="line.41">            }</a>
<span class="sourceLineNo">042</span><a id="line.42">        }</a>
<span class="sourceLineNo">043</span><a id="line.43">        char[][] working = new char[width][height];</a>
<span class="sourceLineNo">044</span><a id="line.44">        for (int iter = 0; iter &lt; 5; iter++) {</a>
<span class="sourceLineNo">045</span><a id="line.45">            for (int x = 0; x &lt; width; x++) {</a>
<span class="sourceLineNo">046</span><a id="line.46">                for (int y = 0; y &lt; height; y++) {</a>
<span class="sourceLineNo">047</span><a id="line.47">                    int sum = 0;</a>
<span class="sourceLineNo">048</span><a id="line.48">                    for (int innerX = -1; innerX &lt;= 1; innerX++) {</a>
<span class="sourceLineNo">049</span><a id="line.49">                        for (int innerY = -1; innerY &lt;= 1; innerY++) {</a>
<span class="sourceLineNo">050</span><a id="line.50">                            if (x + innerX &gt;= 0 &amp;&amp; x + innerX &lt; width</a>
<span class="sourceLineNo">051</span><a id="line.51">                                    &amp;&amp; y + innerY &gt;= 0 &amp;&amp; y + innerY &lt; height</a>
<span class="sourceLineNo">052</span><a id="line.52">                                    &amp;&amp; dungeon[x + innerX][y + innerY] == '.')</a>
<span class="sourceLineNo">053</span><a id="line.53">                                sum++;</a>
<span class="sourceLineNo">054</span><a id="line.54">                        }</a>
<span class="sourceLineNo">055</span><a id="line.55">                    }</a>
<span class="sourceLineNo">056</span><a id="line.56">                    if (sum &lt; 5)</a>
<span class="sourceLineNo">057</span><a id="line.57">                        working[x][y] = '#';</a>
<span class="sourceLineNo">058</span><a id="line.58">                    else</a>
<span class="sourceLineNo">059</span><a id="line.59">                        working[x][y] = '.';</a>
<span class="sourceLineNo">060</span><a id="line.60">                }</a>
<span class="sourceLineNo">061</span><a id="line.61">            }</a>
<span class="sourceLineNo">062</span><a id="line.62">            for (int x = 0; x &lt; width; x++) {</a>
<span class="sourceLineNo">063</span><a id="line.63">                                if (height &gt;= 0) System.arraycopy(working[x], 0, dungeon[x], 0, height);</a>
<span class="sourceLineNo">064</span><a id="line.64">            }</a>
<span class="sourceLineNo">065</span><a id="line.65">        }</a>
<span class="sourceLineNo">066</span><a id="line.66">        return dungeon;</a>
<span class="sourceLineNo">067</span><a id="line.67">    }</a>
<span class="sourceLineNo">068</span><a id="line.68"></a>
<span class="sourceLineNo">069</span><a id="line.69">    /**</a>
<span class="sourceLineNo">070</span><a id="line.70">     * Gets the most recently-produced dungeon as a 2D char array, usually produced by calling {@link #generate()} or</a>
<span class="sourceLineNo">071</span><a id="line.71">     * some similar method present in a specific implementation. This normally passes a direct reference and not a copy,</a>
<span class="sourceLineNo">072</span><a id="line.72">     * so you can normally modify the returned array to propagate changes back into this IDungeonGenerator.</a>
<span class="sourceLineNo">073</span><a id="line.73">     *</a>
<span class="sourceLineNo">074</span><a id="line.74">     * @return the most recently-produced dungeon/map as a 2D char array</a>
<span class="sourceLineNo">075</span><a id="line.75">     */</a>
<span class="sourceLineNo">076</span><a id="line.76">    @Override</a>
<span class="sourceLineNo">077</span><a id="line.77">    public char[][] getDungeon() {</a>
<span class="sourceLineNo">078</span><a id="line.78">        return dungeon;</a>
<span class="sourceLineNo">079</span><a id="line.79">    }</a>
<span class="sourceLineNo">080</span><a id="line.80">}</a>




























































</pre>
</div>
</main>
</body>
</html>
